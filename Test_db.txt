- Total expenses
SELECT test_a.call_logs.UID, COUNT(test_a.call_logs.UID)*(SELECT money from test_a.rates WHERE ID = 3)*CEILING(SUM((SELECT TIMESTAMPDIFF(SECOND, test_a.call_logs.timestamp_start, test_a.call_logs.timestamp_end))/60)) as "Total" FROM test_a.call_logs WHERE test_a.call_logs.Call_dir = "out" AND test_a.call_logs.To NOT IN (SELECT Phone_Number FROM test_a.numbers) GROUP BY test_a.call_logs.UID UNION SELECT test_a.call_logs.UID, COUNT(test_a.call_logs.UID)*(SELECT money FROM test_a.rates WHERE ID = 2)*CEILING(SUM((SELECT TIMESTAMPDIFF(SECOND, test_a.call_logs.timestamp_start, test_a.call_logs.timestamp_end))/60)) as "Total" FROM test_a.call_logs WHERE test_a.call_logs.Call_dir = "out" AND test_a.call_logs.To IN (SELECT Phone_Number FROM test_a.numbers) GROUP BY test_a.call_logs.UID UNION SELECT test_a.call_logs.UID, count(test_a.call_logs.UID)*(SELECT money FROM test_a.rates WHERE ID = 1)*CEILING(SUM((SELECT TIMESTAMPDIFF(SECOND, test_a.call_logs.timestamp_start, test_a.call_logs.timestamp_end))/60)) as "Total" FROM test_a.call_logs WHERE test_a.call_logs.Call_dir = "in" GROUP BY test_a.call_logs.UID;

- Top 10: Most active users
SELECT test_a.call_logs.UID, COUNT(test_a.call_logs.UID) as count FROM test_a.call_logs GROUP BY test_a.call_logs.UID ORDER BY count DESC LIMIT 10;

- Top 10: Users with highest charges, and daily distribution for each of them
SELECT test_a.call_logs.UID, DATE_FORMAT(test_a.call_logs.Timestamp_start , '%d %M %Y' ) as day, COUNT(test_a.call_logs.UID)*(SELECT money FROM test_a.rates where ID = 3)*CEILING(SUM((SELECT TIMESTAMPDIFF(SECOND, test_a.call_logs.timestamp_start, test_a.call_logs.timestamp_end))/60)) as "Total" FROM test_a.call_logs WHERE test_a.call_logs.Call_dir = "out" AND test_a.call_logs.To NOT IN (SELECT Phone_Number FROM test_a.numbers) GROUP BY test_a.call_logs.UID, day ORDER BY Total DESC LIMIT 10;